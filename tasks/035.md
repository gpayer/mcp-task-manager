---
id: 35
parent_id: 33
title: Add relation edges to index layer
status: done
priority: critical
type: feature
created_at: "2026-02-13T14:03:30Z"
updated_at: "2026-02-13T14:12:01Z"
---

Add `RelationEdge` struct and relation storage to the index in `internal/storage/index.go`. Add `relationsBySource` and `relationsByTarget` in-memory maps. Add `relations` array to the persisted `.index.json`. Implement methods: `AddRelation`, `RemoveRelation`, `GetRelationsForTask`, `GetBlockers`, `RemoveAllRelationsForTask`. Update index rebuild to generate edges from task frontmatter (symmetric types like `relates_to` generate reverse edges). Update `NextTodo` to filter out tasks with unresolved `blocked_by` relations.